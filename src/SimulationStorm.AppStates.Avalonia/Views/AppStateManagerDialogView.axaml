<dialogs:DialogControl x:Class="SimulationStorm.AppStates.Avalonia.Views.AppStateManagerDialogView"
                       xmlns="https://github.com/avaloniaui"
                       xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                       xmlns:actipro="http://schemas.actiprosoftware.com/avaloniaui"
                       xmlns:behaviors="using:SimulationStorm.Avalonia.Behaviors"
                       xmlns:dialogs="using:SimulationStorm.Dialogs.Avalonia"
                       xmlns:helpers="using:SimulationStorm.Avalonia.Helpers"
                       xmlns:models="using:SimulationStorm.AppStates.Presentation.Models"
                       xmlns:viewModels="using:SimulationStorm.AppStates.Presentation.ViewModels"
                       xmlns:controls="using:SimulationStorm.Avalonia.Controls"
                       x:DataType="viewModels:AppStateManagerDialogViewModel"
                       Title="{DynamicResource Strings.AppStates.AppSaves}"
                       Width="{actipro:ScaledDouble 120}">
    <DockPanel Classes="stack-items-vertically">
        <actipro:ShadowChrome Elevation="4"
                              Classes="has-bottom-margin">
            <DataGrid x:Name="RecordModelsDataGrid"
                      ItemsSource="{Binding AppStateModels}"
                      LoadingRow="OnRecordModelsDataGridLoadingRow"
                      SelectedItem="{Binding SelectedAppStateModel,
                                         Mode=TwoWay}"
                      Height="{actipro:ScaledDouble 45}">
                <DataGrid.Columns>
                    <DataGridTextColumn x:DataType="models:AppStateModel"
                                        Binding="{Binding OrdinalNumber}"
                                        Header="{DynamicResource Strings.Common.OrdinalNumber}"/>

                    <DataGridTextColumn x:DataType="models:AppStateModel"
                                        Binding="{Binding DateAndTime,
                                                      StringFormat=F}"
                                        Header="{DynamicResource Strings.Common.Date}"/>

                    <DataGridTextColumn x:DataType="models:AppStateModel"
                                        Binding="{Binding Name}"
                                        Header="{DynamicResource Strings.Common.Name}"/>
                </DataGrid.Columns>

                <Interaction.Behaviors>
                    <behaviors:ScrollToLastItemBehavior/>
                </Interaction.Behaviors>

                <DataGrid.Styles>
                    <Style Selector="DataGridRow">
                        <Setter Property="(ToolTip.Tip)" Value="{DynamicResource Strings.AppStates.DoubleClickToEdit}"/>
                    </Style>
                </DataGrid.Styles>
            </DataGrid>
        </actipro:ShadowChrome>

        <DockPanel>
            <Button x:Name="DeleteAllAppStatesButton"
                    helpers:IconHelper.Icon="IconX"
                    Classes="theme-subtle danger hidden-when-disabled"
                    Content="{DynamicResource Strings.AppStates.DeleteAllSaves}"
                    IsEnabled="{Binding !IsRestoringInProgress}"
                    IsVisible="{Binding CanDeleteAllAppStates}"/>

            <StackPanel Orientation="Horizontal"
                        Spacing="{actipro:ScaledDouble 1.5}"
                        DockPanel.Dock="Right"
                        HorizontalAlignment="Right">

                <Button Classes.restoring-in-progress="{Binding IsRestoringInProgress}"
                        Command="{Binding RestoreAppStateCommand}">
                    <Button.Styles>
                        <Style Selector="Button">
                            <Setter Property="Content">
                                <Template>
                                    <ContentControl helpers:IconHelper.Icon="IconRestore"
                                                    Content="{DynamicResource Strings.AppStates.LoadSave}"/>
                                </Template>
                            </Setter>
                            <Style Selector="^.restoring-in-progress">
                                <Setter Property="Content">
                                    <Template>
                                        <controls:ProgressControl Content="{DynamicResource Strings.AppStates.SaveLoading}"/>
                                    </Template>
                                </Setter>
                            </Style>
                        </Style>
                    </Button.Styles>
                </Button>

                <DropDownButton x:Name="SaveAppStateButton"
                                helpers:IconHelper.Icon="IconDeviceFloppy"
                                Classes="theme-solid accent"
                                Content="{DynamicResource Strings.AppStates.SaveApp}"
                                IsEnabled="{Binding !IsRestoringInProgress}"/>
            </StackPanel>
        </DockPanel>
    </DockPanel>
</dialogs:DialogControl>